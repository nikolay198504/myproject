# Интеграция Продамус: статус и рекомендации

## Что уже реализовано

- Реализован backend-эндпоинт `/api/payments/create-link` для генерации платёжной ссылки Продамус (email и телефон необязательны).
- Реализован backend-эндпоинт `/api/payments/webhook` для приёма уведомлений от Продамус с проверкой подписи.
- Оба роутера подключены в `main.py`.
- На фронтенде (в `calc.js`) кнопка "Да" вызывает prompt для email/телефона (необязательно), отправляет запрос на `/api/payments/create-link` и редиректит пользователя на страницу оплаты.
- Старый запрос на `/api/consult_paid` удалён.
- В настройках платёжной формы Продамус указан URL для webhook (`/api/payments/webhook`).
- Success и Fail URL передаются в ссылке (или могут быть указаны в настройках формы).

## Что ещё можно/нужно сделать

- (Рекомендуется) Добавить базу данных для хранения заказов:
    - Сохранять order_id, email, сумму, статус ("ожидание", "оплачен") при создании ссылки.
    - В webhook обновлять статус заказа на "оплачен".
    - (Опционально) Реализовать эндпоинт `/api/payments/status?order_id=...` для проверки статуса заказа (для страницы успеха).
- Реализовать страницы успеха и ошибки (`payment-success`, `payment-fail`):
    - Показывать статус заказа (например, запросом к `/api/payments/status?order_id=...`).
    - Если не реализовано — просто показывать сообщение "Оплата прошла успешно!" или "Оплата не удалась".
- Провести тестирование полного цикла: генерация ссылки → оплата → возврат на сайт → получение webhook.
- (Опционально) Реализовать отправку результата пользователю на email после подтверждения оплаты.

---

**Текущий статус:**

Основная интеграция оплаты через Продамус реализована и готова к тестированию. Для продакшн-уровня рекомендуется добавить хранение заказов и обработку статуса оплаты. 